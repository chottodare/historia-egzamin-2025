<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Historyczny</title>
    
    <script>
      tailwind.config = {
        darkMode: 'class'
      }
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        .hidden { display: none; }
        body { transition: background-color 0.3s, color 0.3s; }
        
        /* Style dla animacji */
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-fade-in-up {
          animation: fadeInUp 0.5s ease-out forwards;
        }
        .opacity-0 {
            opacity: 0;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900">

    <div id="app-container" class="p-4 sm:p-6 flex items-start justify-center min-h-screen">
        <div class="max-w-2xl w-full">
            
            <div id="quiz-view" class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg">
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h1 class="text-2xl font-bold flex items-center text-gray-800 dark:text-white">
                            <i data-lucide="book-open" class="mr-3 text-blue-500"></i>
                            <span id="quiz-title">Quiz Historyczny</span>
                        </h1>
                        <div class="flex items-center gap-4">
                            <button id="dark-mode-toggle-quiz" class="p-2 rounded-lg transition-colors bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-yellow-400">
                                <i data-lucide="sun" class="sun-icon"></i>
                                <i data-lucide="moon" class="moon-icon hidden"></i>
                            </button>
                            <div id="question-counter" class="text-sm text-gray-600 dark:text-gray-400">Pytanie 1 z X</div>
                        </div>
                    </div>
                    
                    <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mb-4">
                        <div id="progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>

                    <div class="rounded-lg p-4 bg-gray-50 dark:bg-gray-700/50">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <i data-lucide="bar-chart-3" class="w-5 h-5 mr-2 text-gray-600 dark:text-gray-400"></i>
                                <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Statystyki og√≥lne:</span>
                            </div>
                            <div class="flex items-center gap-4">
                                <div id="overall-stats-display" class="text-sm text-gray-600 dark:text-gray-400">0/0 (0%)</div>
                                <button id="details-btn-quiz" class="text-sm underline text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300">
                                    Szczeg√≥≈Çy
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-8">
                    <h2 id="question-text" class="text-xl font-semibold mb-6 text-gray-800 dark:text-white">≈Åadowanie pytania...</h2>
                    <div id="options-container" class="space-y-3 mb-6"></div>
                    <div id="explanation-container" class="hidden"></div>

                    <div class="flex justify-end">
                        <button id="check-answer-btn" class="w-full sm:w-auto bg-blue-600 text-white font-bold py-3 px-8 rounded-lg transition-all flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed hover:bg-blue-700">
                            Sprawd≈∫ odpowied≈∫ <i data-lucide="chevron-right" class="w-5 h-5 ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div id="completed-view" class="hidden bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg">
                 <div class="flex justify-end mb-4">
                    <button id="dark-mode-toggle-completed" class="p-2 rounded-lg transition-colors bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-yellow-400">
                       <i data-lucide="sun" class="sun-icon"></i>
                       <i data-lucide="moon" class="moon-icon hidden"></i>
                    </button>
                 </div>
                 <div class="text-center">
                    <div class="text-6xl mb-4">üéâ</div>
                    <h2 id="completed-title" class="text-3xl font-bold mb-4 text-gray-800 dark:text-white">Quiz uko≈Ñczony!</h2>
                    <div class="rounded-lg p-6 mb-6 bg-blue-50 dark:bg-blue-900/30">
                       <h3 class="text-xl font-semibold mb-4 text-blue-800 dark:text-blue-400">Wyniki tego quizu:</h3>
                       <div class="grid grid-cols-2 gap-4 text-center mb-4">
                          <div class="rounded-lg p-4 bg-white dark:bg-gray-700">
                             <div id="current-score" class="text-2xl font-bold text-green-600 dark:text-green-400">0</div>
                             <div class="text-sm text-gray-600 dark:text-gray-400">Poprawne</div>
                          </div>
                          <div class="rounded-lg p-4 bg-white dark:bg-gray-700">
                             <div id="current-accuracy" class="text-2xl font-bold text-purple-600 dark:text-purple-400">0%</div>
                             <div class="text-sm text-gray-600 dark:text-gray-400">Dok≈Çadno≈õƒá</div>
                          </div>
                       </div>
                    </div>
                    <div id="wrong-answers-summary" class="hidden rounded-lg p-4 mb-6 bg-red-50 dark:bg-red-900/20">
                       <h4 class="text-lg font-semibold mb-3 flex items-center justify-center text-red-800 dark:text-red-400">
                          <i data-lucide="alert-circle" class="w-5 h-5 mr-2"></i>
                          B≈Çƒôdne odpowiedzi w tym quizie:
                       </h4>
                       <div id="wrong-answers-list" class="space-y-2 text-left max-h-60 overflow-y-auto pr-2"></div>
                    </div>
                    <div class="flex flex-wrap justify-center gap-3">
                       <button id="new-quiz-btn" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center">
                          <i data-lucide="refresh-cw" class="w-4 h-4 mr-2"></i>Nowy quiz
                       </button>
                       <button id="retake-wrong-btn-completed" class="hidden bg-orange-600 text-white px-6 py-3 rounded-lg hover:bg-orange-700 transition-colors font-medium flex items-center">
                          <i data-lucide="target" class="w-4 h-4 mr-2"></i>Quiz z b≈Çƒôdnych pyta≈Ñ
                       </button>
                       <button id="details-btn-completed" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium flex items-center">
                          <i data-lucide="bar-chart-3" class="w-4 h-4 mr-2"></i>Szczeg√≥≈Çowe statystyki
                       </button>
                    </div>
                 </div>
            </div>

            <div id="stats-view" class="hidden bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg">
                <div class="flex justify-between items-center mb-6">
                  <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Szczeg√≥≈Çowe statystyki</h2>
                  <div class="flex items-center gap-2">
                    <button id="dark-mode-toggle-stats" class="p-2 rounded-lg transition-colors bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-yellow-400">
                       <i data-lucide="sun" class="sun-icon"></i>
                       <i data-lucide="moon" class="moon-icon hidden"></i>
                    </button>
                    <button id="back-to-quiz-btn" class="px-4 py-2 rounded-lg transition-colors text-sm bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600">
                      ‚Üê Powr√≥t
                    </button>
                  </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                  <div class="rounded-lg p-4 bg-blue-50 dark:bg-blue-900/30">
                    <div id="stats-total-quizzes" class="text-2xl font-bold text-blue-600 dark:text-blue-400">0</div>
                    <div class="text-sm text-gray-600 dark:text-gray-400">Uko≈Ñczonych quiz√≥w</div>
                  </div>
                  <div class="rounded-lg p-4 bg-green-50 dark:bg-green-900/30">
                    <div id="stats-correct-answers" class="text-2xl font-bold text-green-600 dark:text-green-400">0</div>
                    <div class="text-sm text-gray-600 dark:text-gray-400">Poprawnych odpowiedzi</div>
                  </div>
                  <div class="rounded-lg p-4 bg-red-50 dark:bg-red-900/30">
                    <div id="stats-wrong-questions-count" class="text-2xl font-bold text-red-600 dark:text-red-400">0</div>
                    <div class="text-sm text-gray-600 dark:text-gray-400">B≈Çƒôdnych pyta≈Ñ</div>
                  </div>
                </div>
                <div id="retake-section-stats" class="hidden mb-8">
                  <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Pytania do powt√≥rzenia</h3>
                    <button id="retake-wrong-btn-stats" class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors text-sm flex items-center">
                      <i data-lucide="target" class="w-4 h-4 mr-2"></i>Quiz z b≈Çƒôdnych pyta≈Ñ
                    </button>
                  </div>
                  <div id="wrong-questions-details-list" class="space-y-4 max-h-96 overflow-y-auto pr-2"></div>
                </div>
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white">Historia quiz√≥w (ostatnie 10)</h3>
                    <div id="quiz-history-list" class="space-y-3"></div>
                </div>
                <div class="flex flex-wrap gap-4 pt-4 border-t border-gray-200 dark:border-gray-700">
                  <button id="download-stats-btn" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center">
                    <i data-lucide="download" class="w-4 h-4 mr-2"></i>Pobierz statystyki
                  </button>
                  <button id="reset-all-data-btn" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors flex items-center">
                    <i data-lucide="alert-circle" class="w-4 h-4 mr-2"></i>Wyczy≈õƒá wszystkie dane
                  </button>
                </div>
            </div>

        </div>
    </div>
    
    <script src="./data/questions.js"></script>

    <script>
        // Ta wersja zawiera ju≈º logikƒô animacji
        const state = {
            currentQuestionIndex: 0,
            selectedAnswer: null,
            showExplanation: false,
            stats: { correct: 0, total: 0 },
            allQuizzes: [],
            wrongQuestions: [],
            isRetakeMode: false,
            darkMode: false,
            quizQuestions: [],
            currentQuizResults: [],
            currentView: 'quiz'
        };

        const quizView = document.getElementById('quiz-view');
        const completedView = document.getElementById('completed-view');
        const statsView = document.getElementById('stats-view');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const checkAnswerBtn = document.getElementById('check-answer-btn');
        const progressBar = document.getElementById('progress-bar');
        const questionCounter = document.getElementById('question-counter');
        const quizTitle = document.getElementById('quiz-title');
        const explanationContainer = document.getElementById('explanation-container');
        const overallStatsDisplay = document.getElementById('overall-stats-display');

        // ... (ca≈Ça reszta kodu logiki JavaScript z poprzedniej odpowiedzi z animacjami) ...
        // ... (wklejam go ponownie poni≈ºej dla 100% pewno≈õci) ...

        function shuffleArray(array) { let currentIndex = array.length, randomIndex; while (currentIndex !== 0) { randomIndex = Math.floor(Math.random() * currentIndex); currentIndex--;[array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]]; } return array; }
        function saveData() { localStorage.setItem('quizStats', JSON.stringify(state.stats)); localStorage.setItem('allQuizzes', JSON.stringify(state.allQuizzes)); localStorage.setItem('wrongQuestions', JSON.stringify(state.wrongQuestions)); }
        function loadData() { state.stats = JSON.parse(localStorage.getItem('quizStats') || '{"correct": 0, "total": 0}'); state.allQuizzes = JSON.parse(localStorage.getItem('allQuizzes') || '[]'); state.wrongQuestions = JSON.parse(localStorage.getItem('wrongQuestions') || '[]'); state.darkMode = JSON.parse(localStorage.getItem('darkMode') || 'false'); }
        function handleAnswer() { if (state.selectedAnswer === null) return; state.showExplanation = true; const currentQ = state.quizQuestions[state.currentQuestionIndex]; const isCorrect = parseInt(state.selectedAnswer) === currentQ.correct; state.currentQuizResults.push({ questionId: currentQ.id, question: currentQ.question, options: currentQ.options, correctAnswer: currentQ.correct, userAnswer: parseInt(state.selectedAnswer), isCorrect: isCorrect, explanation: currentQ.explanation }); state.stats.total++; if(isCorrect) state.stats.correct++; let updatedWrongQuestions = [...state.wrongQuestions]; const existingWrongIndex = updatedWrongQuestions.findIndex(wq => wq.id === currentQ.id); if (isCorrect) { if (existingWrongIndex > -1) { updatedWrongQuestions.splice(existingWrongIndex, 1); } } else { if (existingWrongIndex === -1) { updatedWrongQuestions.push({ ...currentQ, wrongCount: 1 }); } else { updatedWrongQuestions[existingWrongIndex].wrongCount++; } } state.wrongQuestions = updatedWrongQuestions; saveData(); render(); }
        function nextQuestion() { if (state.currentQuestionIndex < state.quizQuestions.length - 1) { state.currentQuestionIndex++; state.selectedAnswer = null; state.showExplanation = false; render(); } else { completeQuiz(); } }
        function completeQuiz() { const quizData = { id: Date.now(), date: new Date().toISOString(), results: state.currentQuizResults, score: state.currentQuizResults.filter(r => r.isCorrect).length, total: state.currentQuizResults.length, isRetake: state.isRetakeMode }; state.allQuizzes.push(quizData); saveData(); state.currentView = 'completed'; render(); }
        function resetQuiz(isRetake = false) { state.currentView = 'quiz'; state.currentQuestionIndex = 0; state.selectedAnswer = null; state.showExplanation = false; state.currentQuizResults = []; if(isRetake && state.wrongQuestions.length > 0) { state.isRetakeMode = true; state.quizQuestions = shuffleArray([...state.wrongQuestions]); } else { state.isRetakeMode = false; state.quizQuestions = shuffleArray([...allAvailableQuestions]); } render(); }
        function resetAllData() { if (window.confirm("Czy na pewno chcesz usunƒÖƒá wszystkie swoje statystyki? Tej operacji nie mo≈ºna cofnƒÖƒá.")) { state.stats = { correct: 0, total: 0 }; state.allQuizzes = []; state.wrongQuestions = []; saveData(); resetQuiz(); } }
        function downloadStats() { const statsData = { overallStats: state.stats, allQuizzes: state.allQuizzes, wrongQuestions: state.wrongQuestions, exportDate: new Date().toISOString() }; const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(statsData, null, 2)); const downloadAnchorNode = document.createElement('a'); downloadAnchorNode.setAttribute("href", dataStr); downloadAnchorNode.setAttribute("download", `quiz-stats-${new Date().toISOString().split('T')[0]}.json`); document.body.appendChild(downloadAnchorNode); downloadAnchorNode.click(); downloadAnchorNode.remove(); }
        function toggleDarkMode() { state.darkMode = !state.darkMode; localStorage.setItem('darkMode', JSON.stringify(state.darkMode)); renderDarkMode(); }
        function renderDarkMode() { document.documentElement.classList.toggle('dark', state.darkMode); document.querySelectorAll('.sun-icon').forEach(i => i.classList.toggle('hidden', state.darkMode)); document.querySelectorAll('.moon-icon').forEach(i => i.classList.toggle('hidden', !state.darkMode)); }
        function renderQuizView() { const questionEl = document.getElementById('question-text'); const optionsEl = document.getElementById('options-container'); questionEl.classList.add('opacity-0'); optionsEl.classList.add('opacity-0'); setTimeout(() => { const currentQ = state.quizQuestions[state.currentQuestionIndex]; if(!currentQ) { quizTitle.textContent = "Brak pyta≈Ñ"; questionText.textContent = state.isRetakeMode ? "Nie masz ≈ºadnych pyta≈Ñ do powt√≥rzenia. Gratulacje!" : "Brak pyta≈Ñ do wy≈õwietlenia."; optionsContainer.innerHTML = ""; checkAnswerBtn.classList.add('hidden'); progressBar.style.width = '100%'; questionCounter.textContent = 'Koniec'; return; } checkAnswerBtn.classList.remove('hidden'); quizTitle.textContent = state.isRetakeMode ? `Quiz Historyczny (Powt√≥rka)` : 'Quiz Historyczny'; questionText.textContent = currentQ.question; questionCounter.textContent = `Pytanie ${state.currentQuestionIndex + 1} z ${state.quizQuestions.length}`; progressBar.style.width = `${((state.currentQuestionIndex + 1) / state.quizQuestions.length) * 100}%`; optionsContainer.innerHTML = ''; currentQ.options.forEach((option, index) => { const isSelected = state.selectedAnswer === index.toString(); const animationDelay = 0.3 + index * 0.1; const labelClasses = `block p-4 border-2 rounded-lg cursor-pointer transition-all opacity-0 animate-fade-in-up`; const optionHtml = `<label class="${labelClasses}" style="animation-delay: ${animationDelay}s;"><input type="radio" name="answer" value="${index}" class="sr-only" ${state.showExplanation ? 'disabled' : ''} ${isSelected ? 'checked' : ''}><div class="flex items-center"><div class="w-5 h-5 rounded-full border-2 mr-4 flex-shrink-0 flex items-center justify-center ${isSelected ? 'border-blue-500' : 'border-gray-300 dark:border-gray-500'}">${isSelected ? '<div class="w-2.5 h-2.5 bg-blue-500 rounded-full"></div>' : ''}</div><span class="text-gray-700 dark:text-gray-200">${option}</span></div></label>`; optionsContainer.innerHTML += optionHtml; }); document.querySelectorAll('input[name="answer"]').forEach(radio => { radio.addEventListener('change', (e) => { state.selectedAnswer = e.target.value; const allLabels = document.querySelectorAll('#options-container label'); allLabels.forEach(lbl => { lbl.classList.remove('border-blue-500', 'bg-blue-50', 'dark:bg-blue-900/30'); }); const selectedLabel = e.target.parentElement.parentElement; selectedLabel.classList.add('border-blue-500', 'bg-blue-50', 'dark:bg-blue-900/30'); }); }); questionEl.classList.remove('opacity-0'); questionEl.classList.add('animate-fade-in-up'); optionsEl.classList.remove('opacity-0'); if (state.showExplanation) { const isCorrect = parseInt(state.selectedAnswer) === currentQ.correct; const explanationClasses = `p-4 rounded-lg mb-6 border ${isCorrect ? 'bg-green-50 border-green-200 dark:bg-green-900/30 dark:border-green-800' : 'bg-red-50 border-red-200 dark:bg-red-900/30 dark:border-red-800'}`; const explanationTitle = isCorrect ? 'Odpowied≈∫ poprawna!' : `Niepoprawna odpowied≈∫. Prawid≈Çowa to: "${currentQ.options[currentQ.correct]}"`; const explanationIcon = isCorrect ? '‚úÖ' : '‚ùå'; const titleClasses = `font-semibold mb-2 ${isCorrect ? 'text-green-800 dark:text-green-400' : 'text-red-800 dark:text-red-400'}`; explanationContainer.innerHTML = `<div class="${explanationClasses}"><div class="flex items-start"><div class="text-2xl mr-3">${explanationIcon}</div><div><div class="${titleClasses}">${explanationTitle}</div><p class="text-sm leading-relaxed text-gray-700 dark:text-gray-300"><strong>Wyja≈õnienie:</strong> ${currentQ.explanation}</p></div></div></div>`; explanationContainer.classList.remove('hidden'); checkAnswerBtn.innerHTML = 'Nastƒôpne pytanie <i data-lucide="chevron-right" class="w-5 h-5 ml-2"></i>'; } else { explanationContainer.classList.add('hidden'); checkAnswerBtn.innerHTML = 'Sprawd≈∫ odpowied≈∫ <i data-lucide="chevron-right" class="w-5 h-5 ml-2"></i>'; } checkAnswerBtn.disabled = state.selectedAnswer === null && !state.showExplanation; const accuracy = state.stats.total > 0 ? Math.round((state.stats.correct / state.stats.total) * 100) : 0; overallStatsDisplay.textContent = `${state.stats.correct}/${state.stats.total} (${accuracy}%)`; lucide.createIcons(); }, 50); }
        function renderCompletedView() { const lastQuiz = state.allQuizzes[state.allQuizzes.length - 1]; const score = lastQuiz.score, total = lastQuiz.total; const accuracy = total > 0 ? Math.round((score/total) * 100) : 0; document.getElementById('completed-title').textContent = lastQuiz.isRetake ? "Quiz (Powt√≥rka) uko≈Ñczony!" : "Quiz uko≈Ñczony!"; document.getElementById('current-score').textContent = score; document.getElementById('current-accuracy').textContent = `${accuracy}%`; const wrongAnswersContainer = document.getElementById('wrong-answers-summary'); const wrongAnswersList = document.getElementById('wrong-answers-list'); const wrongInThisQuiz = lastQuiz.results.filter(r => !r.isCorrect); if(wrongInThisQuiz.length > 0) { wrongAnswersList.innerHTML = wrongInThisQuiz.map(result => `<div class="rounded p-3 text-sm bg-white dark:bg-gray-700"><div class="font-medium mb-1 text-gray-800 dark:text-white">${result.question}</div><div class="text-red-600 dark:text-red-400">Twoja odpowied≈∫: ${result.options[result.userAnswer]}</div><div class="text-green-600 dark:text-green-400">Poprawna: ${result.options[result.correctAnswer]}</div></div>`).join(''); wrongAnswersContainer.classList.remove('hidden'); } else { wrongAnswersContainer.classList.add('hidden'); } document.getElementById('retake-wrong-btn-completed').classList.toggle('hidden', state.wrongQuestions.length === 0); }
        function renderStatsView() { document.getElementById('stats-total-quizzes').textContent = state.allQuizzes.length; document.getElementById('stats-correct-answers').textContent = state.stats.correct; document.getElementById('stats-wrong-questions-count').textContent = state.wrongQuestions.length; const retakeSection = document.getElementById('retake-section-stats'); if (state.wrongQuestions.length > 0) { retakeSection.classList.remove('hidden'); document.getElementById('wrong-questions-details-list').innerHTML = state.wrongQuestions.sort((a,b) => b.wrongCount - a.wrongCount).map(wq => `<div class="border rounded-lg p-4 bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800"><div class="flex justify-between items-start mb-2"><h4 class="font-medium text-gray-800 dark:text-white">${wq.question}</h4><span class="px-2 py-1 rounded text-xs bg-red-100 text-red-800 dark:bg-red-800/50 dark:text-red-300">B≈Çƒôd√≥w: ${wq.wrongCount}</span></div><div class="text-sm mb-2 text-green-700 dark:text-green-400"><strong>Poprawna odpowied≈∫:</strong> ${wq.options[wq.correct]}</div><div class="text-xs text-gray-600 dark:text-gray-400">${wq.explanation}</div></div>`).join(''); } else { retakeSection.classList.add('hidden'); } const historyList = document.getElementById('quiz-history-list'); historyList.innerHTML = [...state.allQuizzes].reverse().slice(0, 10).map((quiz, index) => `<div class="rounded-lg p-4 flex justify-between items-center bg-gray-50 dark:bg-gray-700"><div><div class="font-medium text-gray-800 dark:text-white">Quiz #${state.allQuizzes.length - index} ${quiz.isRetake ? '(Powt√≥rka)' : ''}</div><div class="text-sm text-gray-600 dark:text-gray-400">${new Date(quiz.date).toLocaleString('pl-PL')}</div></div><div class="text-right"><div class="text-lg font-semibold text-gray-800 dark:text-white">${quiz.score}/${quiz.total}</div><div class="text-sm text-gray-600 dark:text-gray-400">${quiz.total > 0 ? Math.round((quiz.score / quiz.total) * 100) : 0}%</div></div></div>`).join(''); }
        function render() { quizView.classList.toggle('hidden', state.currentView !== 'quiz'); completedView.classList.toggle('hidden', state.currentView !== 'completed'); statsView.classList.toggle('hidden', state.currentView !== 'stats'); if (state.currentView === 'quiz') renderQuizView(); else if (state.currentView === 'completed') renderCompletedView(); else if (state.currentView === 'stats') renderStatsView(); lucide.createIcons(); }
        document.addEventListener('DOMContentLoaded', () => { loadData(); document.querySelectorAll('[id^="dark-mode-toggle"]').forEach(btn => btn.addEventListener('click', toggleDarkMode)); checkAnswerBtn.addEventListener('click', () => { state.showExplanation ? nextQuestion() : handleAnswer(); }); document.getElementById('new-quiz-btn').addEventListener('click', () => resetQuiz(false)); document.getElementById('retake-wrong-btn-completed').addEventListener('click', () => resetQuiz(true)); document.getElementById('retake-wrong-btn-stats').addEventListener('click', () => resetQuiz(true)); document.getElementById('details-btn-quiz').addEventListener('click', () => { state.currentView = 'stats'; render(); }); document.getElementById('details-btn-completed').addEventListener('click', () => { state.currentView = 'stats'; render(); }); document.getElementById('back-to-quiz-btn').addEventListener('click', () => { const wasRetake = state.isRetakeMode; state.currentView = 'quiz'; resetQuiz(wasRetake); }); document.getElementById('download-stats-btn').addEventListener('click', downloadStats); document.getElementById('reset-all-data-btn').addEventListener('click', resetAllData); resetQuiz(); renderDarkMode(); });
    </script>
</body>
</html>
